{% extends "layout.html" %}
{% block content %}   


<body>

<div class = "nav_bar_row_index"> 
      <div class = "nav_bar_col_index col-1-24"><a href="/"><span class = "icon-th-list"></span></a></div>
      <div class = "nav_bar_col_index offset-19-24"></div>
      <div class = "nav_bar_col_index col-1-24"><a href="/profile"><span class = "icon-user"></span></a></div>
      <div class = "nav_bar_col_index col-1-24"><a href="/message"><span class = "icon-mail"></span></a></div>
      <div class = "nav_bar_col_index col-1-24"><a href="/search"><span class = "icon-search"></span></a></div>
      <div class = "nav_bar_col_index col-1-24"><a href="/logout"><span class = "icon-logout"></span></a></div>
  </div>



<script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/socket.io/1.3.6/socket.io.min.js"></script>
<script type="text/javascript" charset="utf-8">
    var socket = io.connect();
    socket.on('connect', function() {
        console.log("Sending a message to the server");
    });
</script>

<script type="text/javascript" charset="utf-8">
    socket.on('event', function(messages) {
                console.log("Recieved a message from the server");
                console.log(messages)
                document.getElementById('chat').value = messages;
            });
</script>

 {% for conversation in conversations %}
<script type="text/javascript" charset="utf-8">
var div = document.createElement('button');
div.textContent = "{{conversation}}";
div.setAttribute('id', 'togglebutton-{{conversation}}');
div.setAttribute('value', "{{conversation}}");
document.body.appendChild(div);

var button = document.getElementById('togglebutton-{{conversation}}');

button.addEventListener('click', function(e) {
  var x = e.target.value
  socket.emit('conversation', {conversation: x });


});
</script>
{% endfor %}




<div class="row">
 <textarea id="chat" cols="80" rows="20"></textarea><br><br>
</div>
              
<div class="row">
    <div class="col-8-24">
            <form method="POST">
            {{ conversationform.hidden_tag() }}
            <p>{{ conversationform.conversationtitle.label }} {{ conversationform.conversationtitle() }} </p>
            <p>{{ conversationform.usersinconversation.label }} {{ conversationform.usersinconversation() }} </p>
            {{ conversationform.conversationsubmit }}
            </form>
    </div>
    </div>




<div class="row">
    <div class="col-8-24">
            <form method="POST">
            {{ messageform.hidden_tag() }}
            <p>{{ messageform.msgusername.label }} {{ messageform.msgusername() }} </p>
            <p>{{ messageform.message.label }} {{ messageform.message() }} </p>
            {{ messageform.messagesubmit }}
            </form>

    </div>
    </div>




</body>

{% endblock %}